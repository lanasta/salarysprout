{"ast":null,"code":"const nacl = require('tweetnacl');\n\nconst sha512 = require('js-sha512');\n\nfunction genericHash(arr) {\n  return sha512.sha512_256.array(arr);\n}\n\nfunction randomBytes(length) {\n  return nacl.randomBytes(length);\n}\n\nfunction keyPair() {\n  let seed = randomBytes(nacl.box.secretKeyLength);\n  return keyPairFromSeed(seed);\n}\n\nfunction keyPairFromSeed(seed) {\n  return nacl.sign.keyPair.fromSeed(seed);\n}\n\nfunction keyPairFromSecretKey(sk) {\n  return nacl.sign.keyPair.fromSecretKey(sk);\n}\n\nfunction sign(msg, secretKey) {\n  return nacl.sign.detached(msg, secretKey);\n}\n\nfunction bytesEqual(a, b) {\n  return nacl.verify(a, b);\n}\n\nfunction verify(message, signature, verifyKey) {\n  return nacl.sign.detached.verify(message, signature, verifyKey);\n}\n\nmodule.exports = {\n  genericHash,\n  randomBytes,\n  keyPair,\n  sign,\n  keyPairFromSeed,\n  keyPairFromSecretKey,\n  bytesEqual,\n  verify\n}; // constants\n\nmodule.exports.PUBLIC_KEY_LENGTH = nacl.sign.publicKeyLength;\nmodule.exports.SECRET_KEY_LENGTH = nacl.sign.secretKeyLength;\nmodule.exports.HASH_BYTES_LENGTH = 32;\nmodule.exports.SEED_BTYES_LENGTH = 32;","map":null,"metadata":{},"sourceType":"script"}